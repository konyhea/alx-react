const spawn = require('cross-spawn');
const path = require('path');
const { name: pkgName } = require('../package.json');

const cwd = process.cwd();

const exec = (linter, cmdObj) => {
  // 将 pkgName exec <linter> [...options] 作为 linter [...options] 执行
  const { rawArgs } = cmdObj.parent;
  const linterArgs = rawArgs.slice(rawArgs.indexOf(linter) + 1);
  const result = spawn.sync(path.resolve(cwd, `./node_modules/${pkgName}/node_modules/.bin/${linter}`), linterArgs, { stdio: 'inherit' });

  if (result.status !== 0) {
    process.exit(result.status);
  }
};

module.exports = exec;
