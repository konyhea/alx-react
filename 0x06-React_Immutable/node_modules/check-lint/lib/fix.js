const spawn = require('cross-spawn');
const path = require('path');
const log = require('../utils/log');
const { name: pkgName } = require('../package.json');

const fix = () => {
  const cwd = process.cwd();

  log.info('执行 eslint --fix：');
  spawn.sync(path.resolve(cwd, `./node_modules/${pkgName}/node_modules/.bin/eslint`), [
    '.',
    '--ext',
    'js,jsx,ts,tsx',
    '--fix',
  ], { stdio: 'inherit' });

  log.success(`
代码规约问题自动修复完成，请通过 git diff 确认修复效果 :D
ps. 以上显示的是无法被自动修复的问题，需要手动进行修复
  `);
};

module.exports = fix;
